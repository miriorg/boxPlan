# アプリケーション詳細仕様書

## 1. 概要

### 1.1. アプリケーション名
Box Planner

### 1.2. 目的
ユーザーが指定したスペースの寸法に収まる、最適な収納ボックスの組み合わせプランを提案するWebアプリケーション。

### 1.3. ターゲットユーザー
- これから新生活を始めるため、部屋に合う収納を探している人。
- 整理収納アドバイザーが、クライアントの収納エリアに最適なプランを提案するための支援ツールとして。

## 2. 機能要件

### 2.1. ユーザー入力
- **入力項目:** スペースの「高さ」「幅」「奥行き」
- **単位:** mm (ミリメートル)
- **入力値:** 整数のみ
- **入力上限:** 各寸法について 10,000mm (10m) まで

### 2.2. プランニングロジック
- **基本制約:**
  - プランニングは単一のメーカーの製品群で行う。
  - プランニングはボックスの奥行きサイズを統一して行う。
  - ボックスは格子状（グリッド状）に配置する（列ごとで幅を統一し、行ごとで高さを統一する）。
  - 奥行き方向のボックス配置は1列のみとする。
  - 生成されるプランの全体の高さ・幅は、ユーザーが入力したスペースの寸法を超えない。
- **提案プラン数:**
  - 1〜3プランを提案する。
- **最適化基準:**
  - 以下の優先順位で最適なプランを決定する。
    1. **スペース活用率:** (使用するボックスの総体積 ÷ 指定スペースの体積) が最も高いプラン。
    2. **ボックス総数:** 活用率が同程度の場合、使用するボックスの総数がより少ないプラン。
  - 上記の基準で評価が近いプランが複数ある場合は、使用するボックスの種類や構成が異なるものを複数提示し、利用者が選択できるようにする。

### 2.3. 結果表示
- **レイアウトイメージ Pane:**
  - 生成されたプランの正面図をSVG（Scalable Vector Graphics）で描画する。
  - **ボックスの配色:** ボックスの `幅 × 高さ` の面積に応じて、白から黄色への濃淡（グラデーション）で塗り分ける。面積が最大のボックスが最も淡い色（白に近い）、最小のボックスが最も濃い色（黄色に近い）となる。
  - **エラー表示:** 後述の「2.4. プラン手動調整」機能でレイアウトが指定スペースの寸法を超過した場合、このPane内にその旨を示すエラーメッセージを表示する。
- **レイアウトリスト Pane:**
  - プランで使用されているボックスの情報を表形式で一覧表示する。
  - **表示項目:** メーカー名, 高さ, 幅, 奥行き, 個数

### 2.4. プラン手動調整
- SVGで描画されたボックスをクリックすると、編集用のダイアログが表示される。
- ダイアログには、現在選択中のボックスと「同じメーカー」かつ「同じ奥行き」の、他のサイズのボックス一覧がプルダウンリストで表示される。
- ユーザーがプルダウンから別のボックスを選択して確定すると、クリックされたボックスが含まれる**行全体**のボックスが、新しい高さのボックスに一括で更新される。
- **超過時の挙動:** この変更によって、プラン全体の高さがユーザー指定の高さを超過した場合でも、レイアウトの更新は実行される。ただし、その旨を「レイアウトイメージ Pane」内にエラーとして明記する。

### 2.5. プラン共有機能
- 現在表示しているプランの構成情報を、URLのパラメータとしてエンコード（符号化）する機能を設ける。
- このパラメータが付与されたURLにアクセスすると、Webサイト上でそのプランが再現され、表示・編集ができる状態になる。

## 3. 画面仕様

- **デザインコンセプト:**
  - 全体的にモダンで、明るく淡い配色を基調としたシンプルなデザイン。
- **レスポンシブ対応:**
  - PC、スマートフォンの両方で閲覧・操作が可能であること。特にスマートフォンでの利用体験を優先してレイアウトを最適化する。

## 4. データ仕様

- **収納ボックスデータ:**
  - `plan.md` に記載されている「天馬」「無印良品」の製品情報を、アプリケーションのソースコード内に静的なデータとして保持する。
  - ユーザーがブラウザ上でボックスの情報を追加・編集する機能は設けない。製品情報の更新はソースコードの修正によって行う。

## 5. 開発・運用

- **技術スタック:**
  - **フロントエンド:** JavaScript, HTML, CSS (具体的なフレームワークは開発段階で選定)
- **ソースコード管理:**
  - GitHub
- **ホスティング・デプロイ:**
  - Vercel
- **デプロイフロー:**
  - **本番環境:** `main` ブランチにソースコードがマージされると、自動的に本番環境にデプロイされる。
  - **テスト環境:** 開発者がGitHub上でPull Requestを作成すると、その変更内容を確認できるプレビュー環境がVercelによって自動的に構築される。これにより、本番環境に影響を与えることなく安全に変更内容のテストが可能。
